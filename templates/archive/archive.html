{% extends 'base.html' %}
{% block content %}



    <br>

    <form class="container"
          style="width:100%; background:white; padding:25px; border-radius: 15px; box-shadow: 1px 2px 3px gray;">
        <input type="date" name="fir" id="fir" class="form-item m-2">dan-
        <input type="date" name="sec" id="sec" class="form-item m-2">gacha
        <button type="sumbit" class="btn btn-primary m-2"><i class="fa fa-filter"></i> Filter</button>
        <a href="?fir=day&sec=day" type="button" class="btn btn-primary m-2"><i class="fa fa-filter"></i> Bugun</a>
        <a href="?fir=week&sec=week" type="button" class="btn btn-primary m-2"><i class="fa fa-filter"></i> Hafta</a>
        <a href="?fir=month&sec=month" type="button" class="btn btn-primary m-2"><i class="fa fa-filter"></i> Oy</a>
    </form>
    <div class="h6 text-center">{{ date_string }}</div>
    <table class="table table-hover">
        <tr>
            <td class="bg-primary text-white" style=" border-radius: 10px 0 0 0">№</td>
            <td class="bg-primary text-white">ID</td>
            <td class="bg-primary text-white">
                <div class="dropdown">
                    <button class="btn btn-primary p-0 dropdown-toggle"
                            type="button" id="dropdownMenu1" data-toggle="dropdown"
                            aria-haspopup="true" aria-expanded="false" style="width:100%">
                        Offitsant
                    </button>
                    <div class="dropdown-menu" aria-labelledby="dropdownMenu1">
                        {% for waiter in waiters %}
                            <a class="dropdown-item"
                               onclick="addurlparameter('wtype', {{ waiter.id }})">{{ waiter.full_name }}</a>
                        {% endfor %}
                    </div>
                </div>
            </td>

            <td class="bg-primary text-white">
                <div class="dropdown">
                    <button class="btn btn-primary p-0 dropdown-toggle"
                            type="button" id="dropdownMenu1" data-toggle="dropdown"
                            aria-haspopup="true" aria-expanded="false" style="width:100%">
                        Turi
                    </button>
                    <div class="dropdown-menu" aria-labelledby="dropdownMenu1">
                        <a class="dropdown-item"
                           onclick="addurlparameter('otype', 'in')">Shu yerda</a>
                        <a class="dropdown-item"
                           onclick="addurlparameter('otype', 'out')">Olib ketilgan</a>
                    </div>
                </div>
            </td>
            <td class="bg-primary text-white">Olingan vaqt</td>
            <td class="bg-primary text-white">Stol</td>
            <td class="bg-primary text-white">Xizmat</td>
            <td class="bg-primary text-white">Umumiy summa</td>
            <td class="bg-primary text-white" style=" border-radius: 0 10px 0 0">Tahlil</td>
        </tr>

        {% for order in orders %}
            <tr>
                <td>{{ forloop.counter }}</td>
                <td>#{{ order.id }}</td>
                <td>{{ order.waiter.full_name }}</td>
                {% if order.order_type == 'table' %}
                    <td>Shu yerda</td>
                {% else %}
                    <td>Olib ketilgan</td>
                {% endif %}
                <td>{{ order.created_time }}</td>
                {% if order.order_type == 'table' %}
                <td>{{ order.table.room.title }} №{{ order.table.number }}</td>
                {% else %}
                <td>-------</td>
                {% endif %}
                <td>{{ order.tax_price }}</td>
                <td class="p-0">
                    <table class="table table-sm mb-0">
                        <tr style="padding:0; margin:0; font-size:11px">
                            <td style="padding:0; margin:0; font-size:11px">
                                <i class="fa fa-money"></i>
                            </td>
                            <td style="padding:0; margin:0; font-size:11px">
                                {{ order.paid_money }} so'm
                            </td>
                        </tr>
                        <tr style="padding:0; margin:0; font-size:11px">
                            <td style="padding:0; margin:0; font-size:11px">
                                <i class="fa fa-money"></i>
                            </td>
                            <td style="padding:0; margin:0; font-size:11px">
                                {{ order.paid_money }} so'm
                            </td>
                        </tr>
                        <tr style="padding:0; margin:0; font-size:11px">
                            <td style="padding:0; margin:0; font-size:11px">
                                <i class="fa fa-money"></i>
                            </td>
                            <td style="padding:0; margin:0; font-size:11px">
                                {{ order.paid_money }} so'm
                            </td>
                        </tr>
                    </table>
                </td>
                <td><a href="{% url 'archive_order_view' pk=order.id %}">
                    <button type="button" class="btn btn-info"><i class="fa fa-eye"></i> Tahlil</button>
                </a></td>
            </tr>
        {% endfor %}

    </table>
    <!-- Paginator shu yerga if ishlatib paginator kerak bo`lmasa o`chirib qo`yadigan qiling -->

    <div class="text-center">

        {% if p_paginator.has_previous %}
            <a class="btn btn-primary" href="?page={{ p_paginator.previous_page_number }}"><</a>
        {% endif %}
        <span class="btn btn-primary">

    Sahifa {{ p_paginator.number }}/{{ p_paginator.paginator.num_pages }}
    </span>


        {% if p_paginator.has_next %}
            <a class="btn btn-primary" href="?page={{ p_paginator.next_page_number }}">></a>
        {% endif %}
    </div>
    <div class="h5 font-weight-bold text-danger text-right">Jami: {{ total_sum }} so'm</div>
    <!-- End Paginator -->
    <script type="text/javascript">
        var year = new URL(location.href).searchParams.get('fir');
        document.getElementById("fir").value = year;
        var year = new URL(location.href).searchParams.get('sec');
        document.getElementById("sec").value = year;

        function addurlparameter(name, value) {
            var sp = new URLSearchParams(window.location.search)
            sp.set(name, value)
            window.location.search = sp.toString()
        }
    </script>


{% endblock %}